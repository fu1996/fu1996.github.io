"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[201],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>v});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var i=r.createContext({}),p=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},c=function(e){var n=p(e.components);return r.createElement(i.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},k=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,l=e.originalType,i=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),u=p(t),k=o,v=u["".concat(i,".").concat(k)]||u[k]||d[k]||l;return t?r.createElement(v,s(s({ref:n},c),{},{components:t})):r.createElement(v,s({ref:n},c))}));function v(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var l=t.length,s=new Array(l);s[0]=k;var a={};for(var i in n)hasOwnProperty.call(n,i)&&(a[i]=n[i]);a.originalType=e,a[u]="string"==typeof e?e:o,s[1]=a;for(var p=2;p<l;p++)s[p]=t[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}k.displayName="MDXCreateElement"},57114:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>d,frontMatter:()=>l,metadata:()=>a,toc:()=>p});var r=t(87462),o=(t(67294),t(3905));const l={authors:"junkui",title:"02-3000\u5b57\u56fe\u6587\u5e76\u8302\u7684\u89e3\u6790 webpack \u6838\u5fc3\u5e93 enhanced-resolve \u5de5\u4f5c\u6d41\u7a0b\u548c\u63d2\u62d4\u5f0f\u63d2\u4ef6\u673a\u5236",categories:["js","webpack"],tags:["js","webpack"],date:new Date("2021-08-26T22:50:00.000Z"),sidebar_position:2},s=void 0,a={unversionedId:"webpack5\u6e90\u7801\u89e3\u6790/02-3000\u5b57\u56fe\u6587\u5e76\u8302\u7684\u89e3\u6790 webpack \u6838\u5fc3\u5e93 enhanced-resolve \u5de5\u4f5c\u6d41\u7a0b\u548c\u63d2\u62d4\u5f0f\u63d2\u4ef6\u673a\u5236",id:"webpack5\u6e90\u7801\u89e3\u6790/02-3000\u5b57\u56fe\u6587\u5e76\u8302\u7684\u89e3\u6790 webpack \u6838\u5fc3\u5e93 enhanced-resolve \u5de5\u4f5c\u6d41\u7a0b\u548c\u63d2\u62d4\u5f0f\u63d2\u4ef6\u673a\u5236",title:"02-3000\u5b57\u56fe\u6587\u5e76\u8302\u7684\u89e3\u6790 webpack \u6838\u5fc3\u5e93 enhanced-resolve \u5de5\u4f5c\u6d41\u7a0b\u548c\u63d2\u62d4\u5f0f\u63d2\u4ef6\u673a\u5236",description:"0. \u98df\u7528\u672c\u6587\u7684\u6587\u6863\u8bf4\u660e\uff1a",source:"@site/webpack/webpack5\u6e90\u7801\u89e3\u6790/02-3000\u5b57\u56fe\u6587\u5e76\u8302\u7684\u89e3\u6790 webpack \u6838\u5fc3\u5e93 enhanced-resolve \u5de5\u4f5c\u6d41\u7a0b\u548c\u63d2\u62d4\u5f0f\u63d2\u4ef6\u673a\u5236.md",sourceDirName:"webpack5\u6e90\u7801\u89e3\u6790",slug:"/webpack5\u6e90\u7801\u89e3\u6790/02-3000\u5b57\u56fe\u6587\u5e76\u8302\u7684\u89e3\u6790 webpack \u6838\u5fc3\u5e93 enhanced-resolve \u5de5\u4f5c\u6d41\u7a0b\u548c\u63d2\u62d4\u5f0f\u63d2\u4ef6\u673a\u5236",permalink:"/webpack/webpack5\u6e90\u7801\u89e3\u6790/02-3000\u5b57\u56fe\u6587\u5e76\u8302\u7684\u89e3\u6790 webpack \u6838\u5fc3\u5e93 enhanced-resolve \u5de5\u4f5c\u6d41\u7a0b\u548c\u63d2\u62d4\u5f0f\u63d2\u4ef6\u673a\u5236",draft:!1,editUrl:"https://github.com/fu1996/fu1996.github.io/tree/main/webpack/webpack5\u6e90\u7801\u89e3\u6790/02-3000\u5b57\u56fe\u6587\u5e76\u8302\u7684\u89e3\u6790 webpack \u6838\u5fc3\u5e93 enhanced-resolve \u5de5\u4f5c\u6d41\u7a0b\u548c\u63d2\u62d4\u5f0f\u63d2\u4ef6\u673a\u5236.md",tags:[{label:"js",permalink:"/webpack/tags/js"},{label:"webpack",permalink:"/webpack/tags/webpack"}],version:"current",lastUpdatedBy:"fjk",lastUpdatedAt:1694966949,formattedLastUpdatedAt:"2023\u5e749\u670817\u65e5",sidebarPosition:2,frontMatter:{authors:"junkui",title:"02-3000\u5b57\u56fe\u6587\u5e76\u8302\u7684\u89e3\u6790 webpack \u6838\u5fc3\u5e93 enhanced-resolve \u5de5\u4f5c\u6d41\u7a0b\u548c\u63d2\u62d4\u5f0f\u63d2\u4ef6\u673a\u5236",categories:["js","webpack"],tags:["js","webpack"],date:"2021-08-26T22:50:00.000Z",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"01-webpack \u6253\u5305\u539f\u7406",permalink:"/webpack/"},next:{title:"03-\u8017\u65f67\u4e2a\u5c0f\u65f6\uff0c\u7528\u8fd150\u5f20\u56fe\u6765\u5b66\u4e60enhance-resolve\u4e2d\u7684\u6570\u636e\u6d41\u52a8\u548c\u63d2\u4ef6\u8c03\u5ea6\u673a\u5236",permalink:"/webpack/webpack5\u6e90\u7801\u89e3\u6790/\u8017\u65f67\u4e2a\u5c0f\u65f6\uff0c\u7528\u8fd150\u5f20\u56fe\u6765\u5b66\u4e60enhance-resolve\u4e2d\u7684\u6570\u636e\u6d41\u52a8\u548c\u63d2\u4ef6\u8c03\u5ea6\u673a\u5236"}},i={},p=[{value:"0. \u98df\u7528\u672c\u6587\u7684\u6587\u6863\u8bf4\u660e\uff1a",id:"0-\u98df\u7528\u672c\u6587\u7684\u6587\u6863\u8bf4\u660e",level:2},{value:"1. \u521d\u6b65\u4e86\u89e3\u8be5\u5e93\u7684\u4f5c\u7528\uff0c\u660e\u767d\u8fd9\u4e2a\u5e93\u662f\u5e72\u5565\u7684\uff1f",id:"1-\u521d\u6b65\u4e86\u89e3\u8be5\u5e93\u7684\u4f5c\u7528\u660e\u767d\u8fd9\u4e2a\u5e93\u662f\u5e72\u5565\u7684",level:2},{value:"2. \u62c9\u53d6\u5e76\u8dd1\u8d77\u6765\u4e00\u4e2a\u7b80\u5355\u7684 demo\uff0c\u521d\u6b65\u4e86\u89e3\u8be5\u5e93\u5bf9\u4e8e resolve \u7684 enhance \uff08\u589e\u5f3a\uff09",id:"2-\u62c9\u53d6\u5e76\u8dd1\u8d77\u6765\u4e00\u4e2a\u7b80\u5355\u7684-demo\u521d\u6b65\u4e86\u89e3\u8be5\u5e93\u5bf9\u4e8e-resolve-\u7684-enhance-\u589e\u5f3a",level:2},{value:"3. \u5f00\u542f Debug \u6a21\u5f0f\uff0c\u5206\u6790\u5927\u4f53\u903b\u8f91",id:"3-\u5f00\u542f-debug-\u6a21\u5f0f\u5206\u6790\u5927\u4f53\u903b\u8f91",level:2},{value:"3.1 webStorm \u4f7f\u7528 debug \u6a21\u5f0f \uff08\u4e0d\u662f\u672c\u6587\u91cd\u70b9\uff0c\u7b80\u5355\u8bf4\u660e\u4e00\u4e0b\uff09",id:"31-webstorm-\u4f7f\u7528-debug-\u6a21\u5f0f-\u4e0d\u662f\u672c\u6587\u91cd\u70b9\u7b80\u5355\u8bf4\u660e\u4e00\u4e0b",level:3},{value:"3.2 vscode \u4f7f\u7528 debug \u6a21\u5f0f",id:"32-vscode-\u4f7f\u7528-debug-\u6a21\u5f0f",level:3},{value:"3.2 \u5206\u6790\u5927\u4f53\u903b\u8f91",id:"32-\u5206\u6790\u5927\u4f53\u903b\u8f91",level:3},{value:"3.2.1 \u4f7f\u7528 <code>ResolverFactory</code> \u5de5\u5382\u7c7b \u8c03\u7528 <code>createResolver</code> \u65b9\u6cd5 \u521b\u5efa\u4e00\u4e2a resolver \u5b9e\u4f8b",id:"321-\u4f7f\u7528-resolverfactory-\u5de5\u5382\u7c7b-\u8c03\u7528-createresolver-\u65b9\u6cd5-\u521b\u5efa\u4e00\u4e2a-resolver-\u5b9e\u4f8b",level:4},{value:"3.2.2 \u8fdb\u5165 <code>createResolver</code> \u65b9\u6cd5 \u5927\u81f4\u5206\u6790\u6d41\u7a0b \uff08\u8fdb\u5165\u8be5\u65b9\u6cd5\uff1a\u6309\u4f4f Ctrl + \u3010\u9f20\u6807\u5de6\u952e\u70b9\u51fb\u3011\uff09",id:"322-\u8fdb\u5165-createresolver-\u65b9\u6cd5-\u5927\u81f4\u5206\u6790\u6d41\u7a0b-\u8fdb\u5165\u8be5\u65b9\u6cd5\u6309\u4f4f-ctrl--\u9f20\u6807\u5de6\u952e\u70b9\u51fb",level:4},{value:"3.3 \u7c97\u7565\u8fc7\u4e0b <code>Resolver</code> \u7c7b\u7684\u65b9\u6cd5",id:"33-\u7c97\u7565\u8fc7\u4e0b-resolver-\u7c7b\u7684\u65b9\u6cd5",level:3},{value:"3.3.1 \u521d\u6b65\u4e86\u89e3 <code>resolve</code> \u65b9\u6cd5",id:"331-\u521d\u6b65\u4e86\u89e3-resolve-\u65b9\u6cd5",level:4},{value:"3.3.2 \u521d\u6b65\u4e86\u89e3 <code>doResolve</code> \u65b9\u6cd5",id:"332-\u521d\u6b65\u4e86\u89e3-doresolve-\u65b9\u6cd5",level:4},{value:"3.3.3 \u53bb <code>ResolverFactory.js</code> \u6587\u4ef6\u5bfb\u627e\u6ce8\u518c\u4e86 resolve \u4e8b\u4ef6\u7684 \u94a9\u5b50",id:"333-\u53bb-resolverfactoryjs-\u6587\u4ef6\u5bfb\u627e\u6ce8\u518c\u4e86-resolve-\u4e8b\u4ef6\u7684-\u94a9\u5b50",level:4},{value:"3.3.4 \u53bb <code>ParsePlugin</code> \u63d2\u4ef6\u91cc\uff0c\u770b\u6700\u540e\u4e00\u5c42\u7684\u5904\u7406\u903b\u8f91\uff0c\u5b9e\u73b0\u95ed\u73af",id:"334-\u53bb-parseplugin-\u63d2\u4ef6\u91cc\u770b\u6700\u540e\u4e00\u5c42\u7684\u5904\u7406\u903b\u8f91\u5b9e\u73b0\u95ed\u73af",level:4},{value:"4. \u5b8c\u7ed3\u6492\u82b1",id:"4-\u5b8c\u7ed3\u6492\u82b1",level:2}],c={toc:p},u="wrapper";function d(e){let{components:n,...l}=e;return(0,o.kt)(u,(0,r.Z)({},c,l,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"0-\u98df\u7528\u672c\u6587\u7684\u6587\u6863\u8bf4\u660e"},"0. \u98df\u7528\u672c\u6587\u7684\u6587\u6863\u8bf4\u660e\uff1a"),(0,o.kt)("p",null,"\u56e0\u4e3a\u7bc7\u5e45\u6709\u9650\uff0c\u5e0c\u671b\u4f60\u638c\u63e1\u4ee5\u4e0b\u524d\u7f6e\u6761\u4ef6\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u5e0c\u671b\u4f60\u6700\u597d\u4e86\u89e3 \u8ba2\u9605\u53d1\u5e03\u6a21\u578b"),(0,o.kt)("li",{parentName:"ul"},"\u5e0c\u671b\u4f60\u77e5\u9053",(0,o.kt)("inlineCode",{parentName:"li"},"tapable")," \u7684 \u4ee5\u4e0b 3 \u4e2a\u94a9\u5b50\u51fd\u6570",(0,o.kt)("inlineCode",{parentName:"li"},"AsyncSeriesBailHook, AsyncSeriesHook, SyncHook"))),(0,o.kt)("p",null,"\u901a\u8fc7\u672c\u6587\u4f60\u5c06\u5b66\u5230\u5982\u4e0b\u5185\u5bb9\uff08\u6216\u8005\u5e26\u7740\u5982\u4e0b\u7591\u95ee\u53bb\u5b66\u4e60\uff09"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u5982\u4f55",(0,o.kt)("inlineCode",{parentName:"li"},"\u8c03\u8bd5"),"\u4e00\u4e2a nodejs \u5f00\u6e90\u5e93"),(0,o.kt)("li",{parentName:"ul"},"\u4e86\u89e3 ",(0,o.kt)("inlineCode",{parentName:"li"},"webpack")," \u89e3\u6790\u5e93 enhance-resolve \u7684\u5927\u81f4\u5de5\u4f5c\u6d41\u7a0b"),(0,o.kt)("li",{parentName:"ul"},"\u521d\u6b65\u4e86\u89e3 webpack/enhance-resolve \u4e2d ",(0,o.kt)("inlineCode",{parentName:"li"},"tapable")," \u7684\u4f7f\u7528\uff0c\u4ee5\u53ca",(0,o.kt)("inlineCode",{parentName:"li"},"\u63d2\u4ef6\u673a\u5236\u5b9e\u73b0\u7684\u539f\u7406")," \uff08\u8fd9\u91cc\u5199 webpack\uff0c\u662f\u56e0\u4e3a\u4e8c\u8005\u7684\u63d2\u4ef6\u673a\u5236\u662f\u4e00\u6837\u7684\u5b9e\u73b0\u539f\u7406\uff09")),(0,o.kt)("p",null,"\u672c\u6587 GitHub \u89e3\u6790\u5730\u5740\uff1a ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/fu1996/enhanced-resolve/tree/feature-study-enhanced"},"fu1996/enhanced-resolve at feature-study-enhanced (github.com)")),(0,o.kt)("p",null,"\u5148\u770b\u5168\u6587\uff0c\u518d\u8003\u8651\u8981\u4e0d\u8981\u7ed9\u4e2a",(0,o.kt)("inlineCode",{parentName:"p"},"star"),"\u2b50\ufe0f\u3002"),(0,o.kt)("h2",{id:"1-\u521d\u6b65\u4e86\u89e3\u8be5\u5e93\u7684\u4f5c\u7528\u660e\u767d\u8fd9\u4e2a\u5e93\u662f\u5e72\u5565\u7684"},"1. \u521d\u6b65\u4e86\u89e3\u8be5\u5e93\u7684\u4f5c\u7528\uff0c\u660e\u767d\u8fd9\u4e2a\u5e93\u662f\u5e72\u5565\u7684\uff1f"),(0,o.kt)("p",null,"\u60f3\u521d\u6b65\u4e86\u89e3\u4e00\u4e2a\u5e93\u7684\u4f5c\u7528\uff0c\u4ee5\u53ca\u5efa\u7acb\u521d\u8877\uff0c\u6700\u597d\u7684\u65b9\u5f0f\u5c31\u662f\u9605\u8bfb\u5f53\u524d\u5e93\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"README.md"),"(\u524d\u63d0\u662f\u8be5\u5e93\u4f5c\u8005\u7ef4\u62a4\u4e86\u6b64\u6587\u6863 \ud83d\ude0a)\u3002"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"README.md"),"\u5185\u5bb9\u5982\u4e0b\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(64476).Z,width:"1512",height:"522"}),"\u7ffb\u8bd1\u4e3a\u4e2d\u6587\u5c31\u662f\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(72631).Z,width:"1212",height:"434"}),"\u5927\u5bb6\u60f3\u4e86\u89e3\u5173\u4e8e\u539f\u751f\u7684 require.resolve \u7684\u4ecb\u7ecd\u53ef\u4ee5\u770b\u8fd9\u7bc7\u6587\u7ae0 ===> ",(0,o.kt)("a",{parentName:"p",href:"https://juejin.cn/post/6844904055806885895"},"node \u7684\u8def\u5f84\u89e3\u6790 require.resolve - \u6398\u91d1 (juejin.cn)")),(0,o.kt)("p",null,"\u8be5\u5e93\u4e5f\u662f\u4f5c\u4e3a ",(0,o.kt)("inlineCode",{parentName:"p"},"webpack")," \u91cc\u6838\u5fc3\u7684\u4f9d\u8d56\u89e3\u6790\u5e93\u5b58\u5728\uff0c\u5728 ",(0,o.kt)("inlineCode",{parentName:"p"},"webpack.config.js")," \u91cc\u914d\u7f6e\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"resolve")," \u5b57\u6bb5 \u5b9e\u9645\u4e0a\u5c31\u662f\u5f53\u505a\u53c2\u6570\u4f20\u9012\u7ed9\u8be5\u5e93\u7684\uff0c\u6240\u4ee5\u6df1\u5165\u7684\u4e86\u89e3\u4e00\u4e0b\u8be5\u5e93\u7684\u5de5\u4f5c\u539f\u7406\u4ee5\u53ca\u63d2\u4ef6\u673a\u5236\u7684\u5b9e\u73b0\uff0c\u4e5f\u6709\u76ca\u4e8e ",(0,o.kt)("inlineCode",{parentName:"p"},"webpack")," \u7684\u4f18\u5316 \u548c \u540e\u671f\u9605\u8bfb ",(0,o.kt)("inlineCode",{parentName:"p"},"webpack")," \u6e90\u7801\u3002"),(0,o.kt)("h2",{id:"2-\u62c9\u53d6\u5e76\u8dd1\u8d77\u6765\u4e00\u4e2a\u7b80\u5355\u7684-demo\u521d\u6b65\u4e86\u89e3\u8be5\u5e93\u5bf9\u4e8e-resolve-\u7684-enhance-\u589e\u5f3a"},"2. \u62c9\u53d6\u5e76\u8dd1\u8d77\u6765\u4e00\u4e2a\u7b80\u5355\u7684 demo\uff0c\u521d\u6b65\u4e86\u89e3\u8be5\u5e93\u5bf9\u4e8e resolve \u7684 enhance \uff08\u589e\u5f3a\uff09"),(0,o.kt)("p",null,"GitHub \u5730\u5740\u5982\u4e0b\uff1a",(0,o.kt)("a",{parentName:"p",href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fwebpack%2Fenhanced-resolve"},"webpack/enhanced-resolve: Offers an async require.resolve function. It's highly configurable. (github.com)")," PS: \u56fd\u5916\u8bbf\u95ee\u8f83\u6162\uff0c\u5f3a\u70c8\u63a8\u8350 \u4f7f\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},"Gitee")," \u5bfc\u5165\u8be5\u4ed3\u5e93 \u3010\u4e0d\u4f1a\u5427\uff0c\u4e0d\u4f1a\u5427\uff0c\u90fd 2023 \u5e74\u4e86\uff0c\u7adf\u7136\u8fd8\u6709\u4eba\u4e0d\u77e5\u9053\u8fd9\u4e2a\u65b9\u6cd5\uff1f\ud83d\udcda\u3011"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(97589).Z,width:"864",height:"528"})),(0,o.kt)("p",null,"\u4ee3\u7801\u62c9\u53d6\u5b8c\u6bd5\u4ee5\u540e\uff0c\u89c2\u5bdf\u9879\u76ee\u76ee\u5f55\uff0c\u53d1\u73b0\u4f7f\u7528\u7684 yarn\uff0c\u6267\u884c ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn install")," \u8fdb\u884c\u5b89\u88c5\u4f9d\u8d56\u5b89\u88c5\u3002\u5982\u679c\u6ca1\u62a5\u9519\u7684\u8bdd\uff0c\u5199\u4e00\u4e2a\u7b80\u5355\u7684 demo \u5c0f\u8bd5\u725b\u5200\u3002"),(0,o.kt)("p",null,"\u65b0\u5efa\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"demo")," \u6587\u4ef6\u5939\uff0c\u5e76\u521b\u5efa ",(0,o.kt)("inlineCode",{parentName:"p"},"test-hook.js")," (\u540d\u79f0\u53ef\u4ee5\u81ea\u5b9a\u4e49)\uff0c\u7136\u540e\u5199\u5165\u5982\u4e0b\u5185\u5bb9\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'const { ResolverFactory, CachedInputFileSystem } = require("../lib");\nconst fs = require("fs");\nconst path = require("path");\n\nconst myResolver = ResolverFactory.createResolver({\n  fileSystem: new CachedInputFileSystem(fs, 4000),\n  extensions: [".json", ".js", ".ts"],\n});\n\nconst context = {};\nconst resolveContext = {};\nconst lookupStartPath = path.resolve(__dirname);\nconst request = "./a";\nmyResolver.resolve(\n  context,\n  lookupStartPath,\n  request,\n  resolveContext,\n  (err, path, result) => {\n    if (err) {\n      console.log("createResolve err: ", err);\n    } else {\n      console.log("createResolve path: ", path);\n    }\n  }\n);\n')),(0,o.kt)("p",null,"\u65b0\u5efa ",(0,o.kt)("inlineCode",{parentName:"p"},"a.js")," \u6587\u4ef6\uff08\u4e0d\u5fc5\u5199\u5165\u5185\u5bb9\uff0c\u8be5\u5e93\u53ea\u505a",(0,o.kt)("inlineCode",{parentName:"p"},"\u8def\u5f84\u89e3\u6790"),"\uff09\uff0c \u6b64\u65f6\u6587\u4ef6\u76ee\u5f55\u5982\u4e0b\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(73906).Z,width:"1396",height:"902"})),(0,o.kt)("p",null,"\u8fd0\u884c",(0,o.kt)("inlineCode",{parentName:"p"},"test-hook.js")," \u8f93\u51fa\u5982\u4e0b\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(5792).Z,width:"1512",height:"213"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"demo \u8fd0\u884c\u6210\u529f"),"\uff0c\u7b2c 2 \u5173\u901a\u8fc7"),(0,o.kt)("h2",{id:"3-\u5f00\u542f-debug-\u6a21\u5f0f\u5206\u6790\u5927\u4f53\u903b\u8f91"},"3. \u5f00\u542f Debug \u6a21\u5f0f\uff0c\u5206\u6790\u5927\u4f53\u903b\u8f91"),(0,o.kt)("p",null,"\u672c\u4eba\u559c\u6b22\u7528 webStorm \u8fdb\u884c\u8c03\u8bd5 \uff08\u4e4b\u524d\u662f\u641e Python \u5f00\u53d1\u7684\uff0c\u4e60\u60ef\u4e86\uff09\u3002"),(0,o.kt)("h3",{id:"31-webstorm-\u4f7f\u7528-debug-\u6a21\u5f0f-\u4e0d\u662f\u672c\u6587\u91cd\u70b9\u7b80\u5355\u8bf4\u660e\u4e00\u4e0b"},"3.1 webStorm \u4f7f\u7528 debug \u6a21\u5f0f \uff08\u4e0d\u662f\u672c\u6587\u91cd\u70b9\uff0c\u7b80\u5355\u8bf4\u660e\u4e00\u4e0b\uff09"),(0,o.kt)("p",null,"webStorm \u7684\u53ea\u9700\u8981 \u5f53\u524d\u6587\u4ef6 \u4e0b ",(0,o.kt)("inlineCode",{parentName:"p"},"\u53f3\u51fb"),"\uff0c\u7136\u540e \u70b9\u51fb ",(0,o.kt)("inlineCode",{parentName:"p"},"Debug test-hook.js")," \u5373\u53ef"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(14171).Z,width:"1512",height:"1199"}),"\u2019"),(0,o.kt)("h3",{id:"32-vscode-\u4f7f\u7528-debug-\u6a21\u5f0f"},"3.2 vscode \u4f7f\u7528 debug \u6a21\u5f0f"),(0,o.kt)("p",null,"vscode \u7684 debug \u65b9\u5f0f\u5f88\u591a\uff0c\u8fd9\u91cc\u53ea\u8bf4\u4e00\u4e2a \u81ea\u5e26 debug \u7ec8\u7aef \u7684\u8c03\u8bd5\u65b9\u6cd5\uff0c\u6b64\u6cd5\u4e5f\u662f\u5f88\u65b9\u4fbf\u8c03\u8bd5 node \u7a0b\u5e8f\u7684\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(28315).Z,width:"1512",height:"435"})," \u70b9\u51fb\u5b8c\u6bd5\u4ee5\u540e\uff0c\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\uff1a\uff08\u4e0a\u9762\u7684 ws \u5730\u5740 \u8bf7\u81ea\u884c\u63a2\u7d22\uff09"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(29663).Z,width:"1512",height:"430"})),(0,o.kt)("p",null,"\u65b0\u7684\u7ec8\u7aef\u9ed8\u8ba4\u662f\u5728 \u6839\u76ee\u5f55\u4e0b\u7684\uff0c\u968f\u4fbf\u5728 test-hook.js \u6253\u4e00\u4e2a \u65ad\u70b9\uff0c\u7136\u540e \u8fd0\u884c node \u547d\u4ee4\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"node demo/test-hook.js\n")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(33969).Z,width:"1512",height:"925"})),(0,o.kt)("p",null,"\u5b83\u5c31\u8fdb\u6765\u4e86\u3002"),(0,o.kt)("h3",{id:"32-\u5206\u6790\u5927\u4f53\u903b\u8f91"},"3.2 \u5206\u6790\u5927\u4f53\u903b\u8f91"),(0,o.kt)("h4",{id:"321-\u4f7f\u7528-resolverfactory-\u5de5\u5382\u7c7b-\u8c03\u7528-createresolver-\u65b9\u6cd5-\u521b\u5efa\u4e00\u4e2a-resolver-\u5b9e\u4f8b"},"3.2.1 \u4f7f\u7528 ",(0,o.kt)("inlineCode",{parentName:"h4"},"ResolverFactory")," \u5de5\u5382\u7c7b \u8c03\u7528 ",(0,o.kt)("inlineCode",{parentName:"h4"},"createResolver")," \u65b9\u6cd5 \u521b\u5efa\u4e00\u4e2a resolver \u5b9e\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'const myResolver = ResolverFactory.createResolver({\n  fileSystem: new CachedInputFileSystem(fs, 4000),\n  extensions: [".json", ".js", ".ts"],\n});\n')),(0,o.kt)("p",null,"\u6211\u770b\u5230\u8fd9\u6bb5\u7684\u4ee3\u7801\u7684\u4e3b\u8981\u903b\u8f91\u5c31\u662f\u53bb\u60f3\uff1a",(0,o.kt)("inlineCode",{parentName:"p"},"\u8fd9\u65b9\u6cd5\u5403\u4e86\u5565\uff1f\u5410\u51fa\u4e86\u5565\uff1f\u80fd\u6839\u636e\u53d8\u91cf\u540d\u5f97\u5230\u5565\uff1f")," \u7136\u540e\u518d\u53bb\u770b\u65b9\u6cd5\u7684\u5927\u81f4\u5b9e\u73b0\u3002"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u8fd9\u65b9\u6cd5\u5403\u4e86 \u7c7b\u4f3c\u4e8e webpack resolver \u91cc\u7684\u914d\u7f6e"),(0,o.kt)("li",{parentName:"ol"},"\u4ece\u547d\u540d\u6765\u731c\u6d4b \u8fd9\u65b9\u6cd5\u5410\u51fa\u4e86 \u4e00\u4e2a myResolver \u7684 \u5bf9\u8c61")),(0,o.kt)("h4",{id:"322-\u8fdb\u5165-createresolver-\u65b9\u6cd5-\u5927\u81f4\u5206\u6790\u6d41\u7a0b-\u8fdb\u5165\u8be5\u65b9\u6cd5\u6309\u4f4f-ctrl--\u9f20\u6807\u5de6\u952e\u70b9\u51fb"},"3.2.2 \u8fdb\u5165 ",(0,o.kt)("inlineCode",{parentName:"h4"},"createResolver")," \u65b9\u6cd5 \u5927\u81f4\u5206\u6790\u6d41\u7a0b \uff08\u8fdb\u5165\u8be5\u65b9\u6cd5\uff1a\u6309\u4f4f Ctrl + \u3010\u9f20\u6807\u5de6\u952e\u70b9\u51fb\u3011\uff09"),(0,o.kt)("p",null,"\u8fd9\u91cc\u53ea\u8d34\u90e8\u5206\u6838\u5fc3\u4ee3\u7801"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'exports.createResolver = function (options) {\n // \u89e3\u6790\u5e76\u89c4\u8303\u5316\u7528\u6237\u4f20\u5165\u7684\u914d\u7f6e\n const normalizedOptions = createOptions(options);\n\n const {\n  plugins: userPlugins,\n } = normalizedOptions;\n\n // \u6df1\u62f7\u8d1d\u4e00\u4e0b \u7528\u6237\u7528\u5230\u7684 plugins\n const plugins = userPlugins.slice();\n // \u6839\u636e\u914d\u7f6e\u521b\u5efa resolver \u5b9e\u4f8b\n const resolver = customResolver\n  ? customResolver\n  : new Resolver(fileSystem, normalizedOptions);\n\n //// pipeline ////\n // \u786e\u4fdd\u8be5 hook \u5b58\u5728\uff0c\u4e0d\u5b58\u5728\u5219\u6ce8\u518c\u5b83\n resolver.ensureHook("resolve");\n resolver.ensureHook("internalResolve");\n\n // \u6839\u636e\u914d\u7f6e \u628a\u7528\u5230\u7684 \u5185\u7f6e plugin \u4e22\u5230 plugins \u5217\u8868\u91cc\n // resolve\n for (const { source, resolveOptions } of [\n  { source: "resolve", resolveOptions: { fullySpecified } },\n  { source: "internal-resolve", resolveOptions: { fullySpecified: false } }\n ]) {\n  if (unsafeCache) {\n   plugins.push(\n    new UnsafeCachePlugin(\n     source,\n     cachePredicate,\n     unsafeCache,\n     cacheWithContext,\n     `new-${source}`\n    )\n   );\n   plugins.push(\n    new ParsePlugin(`new-${source}`, resolveOptions, "parsed-resolve")\n   );\n  } else {\n   plugins.push(new ParsePlugin(source, resolveOptions, "parsed-resolve"));\n  }\n }\n // ...\u7701\u7565\u90e8\u5206plugins.push\u7684\u903b\u8f91\u4ee3\u7801...\n\n //// RESOLVER ////\n // \u904d\u5386 plugins \u5217\u8868 \u5e76\u4f20\u5165resolver \u5b9e\u4f8b\n for (const plugin of plugins) {\n  if (typeof plugin === "function") {\n   // \u662f\u51fd\u6570 this \u6307\u5411 resolver\n   plugin.call(resolver, resolver);\n  } else {\n    // \u662f\u7c7b\uff0c \u5f00\u59cb\u8c03\u7528apply \u65b9\u6cd5 \uff0capply \u65b9\u6cd5 \u4f1a\u6ce8\u518c\u4e00\u4e9b \u4e0a\u9762ensure\u7684 hook\n   plugin.apply(resolver);\n  }\n }\n // \u8fd4\u56deresolve \u5bf9\u8c61\n return resolver;\n};\n')),(0,o.kt)("p",null,"\u4e00\u4e2a\u7b80\u5355\u7684\u6d41\u7a0b\u56fe\u5982\u4e0b\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(1189).Z,width:"327",height:"683"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"plugin.apply(resolver);")," \u6240\u6709\u7684\u4e8b\u4ef6 \u90fd\u5df2\u7ecf\u6210\u529f\u8ba2\u9605\u3002"),(0,o.kt)("p",null,"\u6240\u6709\u7684\u94a9\u5b50\u90fd\u5728 ",(0,o.kt)("inlineCode",{parentName:"p"},"resolver")," \u5bf9\u8c61 \u8eab\u4e0a\u4e86 \uff08\u5b50\u5f39\u5df2\u7ecf\u4e0a\u819b\uff0c\u51c6\u5907\u53d1\u5c04\uff09\u3002"),(0,o.kt)("h3",{id:"33-\u7c97\u7565\u8fc7\u4e0b-resolver-\u7c7b\u7684\u65b9\u6cd5"},"3.3 \u7c97\u7565\u8fc7\u4e0b ",(0,o.kt)("inlineCode",{parentName:"h3"},"Resolver")," \u7c7b\u7684\u65b9\u6cd5"),(0,o.kt)("p",null,"\u6211\u4eec\u4f7f\u7528 resolver \u7684 \u65b9\u5f0f\u5982\u4e0b\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'const context = {};\nconst resolveContext = {};\nconst lookupStartPath = path.resolve(__dirname);\nconst request = "./a";\nmyResolver.resolve(\n  context,\n  lookupStartPath,\n  request,\n  resolveContext,\n  (err, path, result) => {\n    if (err) {\n      console.log("createResolve err: ", err);\n    } else {\n      console.log("createResolve path: ", path);\n    }\n  }\n);\n')),(0,o.kt)("p",null,"\u90a3\u7b2c\u4e00\u6b65\u5c31\u662f \u770b ",(0,o.kt)("inlineCode",{parentName:"p"},"resolve")," \u65b9\u6cd5"),(0,o.kt)("h4",{id:"331-\u521d\u6b65\u4e86\u89e3-resolve-\u65b9\u6cd5"},"3.3.1 \u521d\u6b65\u4e86\u89e3 ",(0,o.kt)("inlineCode",{parentName:"h4"},"resolve")," \u65b9\u6cd5"),(0,o.kt)("p",null,"\u6838\u5fc3\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,o.kt)("p",null,"\u770b\u6e90\u4ee3\u7801\u65f6\u5019\u4e0d\u80fd\u5fc3\u6025\uff0c\u7b2c\u4e00\u6b65 \u5e94\u8be5\u4fdd\u5927\u4e22\u5c0f\uff0c\u5148\u638c\u63e1\u5168\u5c40\u89c6\u89d2\uff0c\u7136\u540e\u9010\u4e2a\u6df1\u5165\uff0c\u770b\u5230\u540e\u671f\uff0c\u4f1a\u6709\u604d\u7136\u5927\u609f\u7684\u611f\u89c9\uff0c\u539f\u6765\u90a3\u5757\u5199\u7684\u662f\u8fd9\u4e2a\u610f\u601d\u554a\u3002\ud83e\udd14"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'class Resolver {\n  resolve(context, path, request, resolveContext, callback) {\n    // \u6240\u6709\u6d41\u7a0b\u7684\u6838\u5fc3 \u5c31\u662f\u8fd9\u4e2a obj \u5bf9\u8c61\n    const obj = {\n      context: context,\n      path: path,\n      request: request,\n    };\n\n    const message = `resolve \'${request}\' in \'${path}\'`;\n\n    const finishResolved = (result) => {\n      return callback(\n        null,\n        result.path === false\n          ? false\n          : `${result.path.replace(/#/g, "\\0#")}${\n              result.query ? result.query.replace(/#/g, "\\0#") : ""\n            }${result.fragment || ""}`,\n        result\n      );\n    };\n\n    const finishWithoutResolve = (log) => {\n      /`\n       * @type {Error & {details?: string}}\n       */\n      const error = new Error("Can\'t " + message);\n      error.details = log.join("\\n");\n      this.hooks.noResolve.call(obj, error);\n      return callback(error);\n    };\n\n    if (resolveContext.log) {\n      // We need log anyway to capture it in case of an error\n      const parentLog = resolveContext.log;\n      const log = [];\n      return this.doResolve(\n        this.hooks.resolve,\n        obj,\n        message,\n        {\n          log: (msg) => {\n            parentLog(msg);\n            log.push(msg);\n          },\n          yield: yield_,\n          fileDependencies: resolveContext.fileDependencies,\n          contextDependencies: resolveContext.contextDependencies,\n          missingDependencies: resolveContext.missingDependencies,\n          stack: resolveContext.stack,\n        },\n        (err, result) => {\n          if (err) return callback(err);\n\n          if (yieldCalled || (result && yield_)) return finishYield(result);\n          if (result) return finishResolved(result);\n\n          return finishWithoutResolve(log);\n        }\n      );\n    } else {\n      // Try to resolve assuming there is no error\n      // We don\'t log stuff in this case\n      return this.doResolve(\n        this.hooks.resolve,\n        obj,\n        message,\n        {\n          log: undefined,\n          yield: yield_,\n          fileDependencies: resolveContext.fileDependencies,\n          contextDependencies: resolveContext.contextDependencies,\n          missingDependencies: resolveContext.missingDependencies,\n          stack: resolveContext.stack,\n        },\n        (err, result) => {\n          if (err) return callback(err);\n\n          if (yieldCalled || (result && yield_)) return finishYield(result);\n          if (result) return finishResolved(result);\n\n          // log is missing for the error details\n          // so we redo the resolving for the log info\n          // this is more expensive to the success case\n          // is assumed by default\n\n          const log = [];\n\n          return this.doResolve(\n            this.hooks.resolve,\n            obj,\n            message,\n            {\n              log: (msg) => log.push(msg),\n              yield: yield_,\n              stack: resolveContext.stack,\n            },\n            (err, result) => {\n              if (err) return callback(err);\n\n              // In a case that there is a race condition and yield will be called\n              if (yieldCalled || (result && yield_)) return finishYield(result);\n\n              return finishWithoutResolve(log);\n            }\n          );\n        }\n      );\n    }\n  }\n}\n')),(0,o.kt)("p",null,"\u5927\u81f4\u770b\u5b8c\uff0c\u53d1\u73b0\u8fd9\u4e00\u6b65\u5176\u5b9e\u4e5f\u662f\u6839\u636e\u4e0d\u540c\u7684\u6761\u4ef6\u53bb\u7ec4\u88c5\u6570\u636e\uff0c\u628a\u4f20\u5165\u7684\u6570\u636e\uff0c\u8d4b\u503c\u5230 obj \u5bf9\u8c61\u4e0a\uff0c\u7136\u540e\u628a obj \u5bf9\u8c61\u4f20\u5165",(0,o.kt)("inlineCode",{parentName:"p"},"doResolve")," \u65b9\u6cd5\uff0c\u5f53\u505a\u6b64\u65b9\u6cd5\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u771f\u6b63\u8c03\u7528\u7684\u8fd8\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"doResolve")," \u65b9\u6cd5\uff0c\u4e0b\u4e00\u6b65\u5c31\u662f\u5927\u81f4\u7785\u4e0b",(0,o.kt)("inlineCode",{parentName:"p"},"doResolve"),"\u65b9\u6cd5\u3002"),(0,o.kt)("h4",{id:"332-\u521d\u6b65\u4e86\u89e3-doresolve-\u65b9\u6cd5"},"3.3.2 \u521d\u6b65\u4e86\u89e3 ",(0,o.kt)("inlineCode",{parentName:"h4"},"doResolve")," \u65b9\u6cd5"),(0,o.kt)("p",null,"\u4e0a\u9762",(0,o.kt)("inlineCode",{parentName:"p"},"resolve"),"\u4f20\u9012\u7684 obj \u5bf9\u8c61\u4f5c\u4e3a doResolve \u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u547d\u540d\u4e3a\uff1a",(0,o.kt)("inlineCode",{parentName:"p"},"request"),"\uff0c\u4e00\u8d77\u6765\u770b\u4e0b\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'doResolve(hook, request, message, resolveContext, callback) {\n // \u9759\u6001\u65b9\u6cd5 \u6839\u636e\u5f53\u524d hook \u4fe1\u606f \u751f\u6210 \u8c03\u7528\u6808\u4fe1\u606f\n const stackEntry = Resolver.createStackEntry(hook, request);\n\n let newStack;\n // \u5f53\u524d hook \u8c03\u7528\u6808\u4fe1\u606f \u5b58\u5165 newStack \u91cc\n if (resolveContext.stack) {\n  newStack = new Set(resolveContext.stack);\n  if (resolveContext.stack.has(stackEntry)) {\n   /`\n    * Prevent recursion\n    * @type {Error & {recursion?: boolean}}\n    */\n   const recursionError = new Error(\n    "Recursion in resolving\\nStack:\\n  " +\n     Array.from(newStack).join("\\n  ")\n   );\n   recursionError.recursion = true;\n   if (resolveContext.log)\n    resolveContext.log("abort resolving because of recursion");\n   return callback(recursionError);\n  }\n  newStack.add(stackEntry);\n } else {\n  newStack = new Set([stackEntry]);\n }\n // \u4f20\u5165 hook, request \u8c03\u7528 resolveStep \u7684 hook\n this.hooks.resolveStep.call(hook, request);\n // \u5982\u679c\u5f53\u524dhook \u88ab\u4f7f\u7528\u4e86\n if (hook.isUsed()) {\n  const innerContext = createInnerContext(\n   {\n    log: resolveContext.log,\n    yield: resolveContext.yield,\n    fileDependencies: resolveContext.fileDependencies,\n    contextDependencies: resolveContext.contextDependencies,\n    missingDependencies: resolveContext.missingDependencies,\n    stack: newStack\n   },\n   message\n  );\n  // \u89e6\u53d1\u5f53\u524dhook \u5e76\u4f20\u5165 request \u548c innerContext \u5f53\u505a\u53c2\u6570\n  return hook.callAsync(request, innerContext, (err, result) => {\n   if (err) return callback(err);\n   if (result) return callback(null, result);\n   callback();\n  });\n } else {\n  // \u6267\u884c callback \u903b\u8f91\n  callback();\n }\n}\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"callback"),"\u7684\u903b\u8f91\u6bd4\u8f83\u7b80\u5355\uff0c\u6211\u4eec\u5e94\u8be5\u770b\u5f53\u524d ",(0,o.kt)("inlineCode",{parentName:"p"},"hook")," (\u6307\u7684\u662f\uff1athis.hooks.resolve)\u88ab\u4f7f\u7528\u7684\u65f6\u5019\uff0cresolve \u7684\u5904\u7406\u903b\u8f91\u3002"),(0,o.kt)("p",null,"\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"hook.callAsync(request, innerContext, (err, result) => {\n")),(0,o.kt)("p",null,"\u5f53\u524d hook \u76f4\u63a5\u8c03\u7528\u4e86 ",(0,o.kt)("inlineCode",{parentName:"p"},"callAsync")," \u8fdb\u884c\u4e86 \u89e6\u53d1\u4e4b\u524d ",(0,o.kt)("inlineCode",{parentName:"p"},"plugin")," \u7684\u8ba2\u9605\u4e8b\u4ef6\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u8981\u53bb\u627e\u5230\u4e4b\u524d ",(0,o.kt)("inlineCode",{parentName:"p"},"plugin.apply(resolver);")," \u7684\u65f6\u5019\uff0c\u54ea\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"plugin")," \u7684\u8ba2\u9605\u7c7b\u578b \u4e3a",(0,o.kt)("inlineCode",{parentName:"p"},"resolve")," \u4e8b\u4ef6\u3002"),(0,o.kt)("h4",{id:"333-\u53bb-resolverfactoryjs-\u6587\u4ef6\u5bfb\u627e\u6ce8\u518c\u4e86-resolve-\u4e8b\u4ef6\u7684-\u94a9\u5b50"},"3.3.3 \u53bb ",(0,o.kt)("inlineCode",{parentName:"h4"},"ResolverFactory.js")," \u6587\u4ef6\u5bfb\u627e\u6ce8\u518c\u4e86 resolve \u4e8b\u4ef6\u7684 \u94a9\u5b50"),(0,o.kt)("p",null,"\u573a\u666f\u5207\u56de\u5230 ",(0,o.kt)("inlineCode",{parentName:"p"},"ResolverFactory.js")," \u6587\u4ef6\uff0c\u663e\u800c\u6613\u89c1\u7684\u5728 ",(0,o.kt)("inlineCode",{parentName:"p"},"327")," \u884c\u5de6\u53f3 \u770b\u5230\u4e86\u8fd9\u4e2a\u6ce8\u518c\u4e8b\u4ef6\uff0c\u6b64 demo \u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"unsafeCache")," \u4e3a",(0,o.kt)("inlineCode",{parentName:"p"},"false")," \u6240\u4ee5\u6b64\u5904 \u6267\u884c\u7684\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"347")," \u884c\u7684\u4ee3\u7801 \uff08\u5173\u4e8e\u6b64\u53c2\u6570\u7684\u4f5c\u7528\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"\u5148 TODO \u4e0b"),"\uff0c\u7b2c\u4e00\u6b21\u770b\u6e90\u7801\u4e0d\u80fd\u8ffd\u6df1\uff0c\u5e94\u8be5\u8ffd\u5e7f\uff09\u3002\u8fd9\u6b21\u8981\u8fdb\u5165",(0,o.kt)("inlineCode",{parentName:"p"},"ParsePlugin")," \u63d2\u4ef6\u91cc\uff0c\u770b\u5b83\u5230\u5e95\u5b9e\u73b0\u4e86\u54ea\u4e9b\u903b\u8f91\u3002\uff08\u4f18\u79c0\u7684\u5f00\u6e90\u5e93\uff0c\u5173\u4e8e\u4e8b\u4ef6\u548c\u6570\u636e\u7684\u5904\u7406\u5c31\u662f\u8fd9\u4e48 ",(0,o.kt)("inlineCode",{parentName:"p"},"callback"),"\uff0c\u5fc5\u987b\u8010\u5fc3 \ud83d\ude0a\uff09"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(27269).Z,width:"1512",height:"851"})),(0,o.kt)("h4",{id:"334-\u53bb-parseplugin-\u63d2\u4ef6\u91cc\u770b\u6700\u540e\u4e00\u5c42\u7684\u5904\u7406\u903b\u8f91\u5b9e\u73b0\u95ed\u73af"},"3.3.4 \u53bb ",(0,o.kt)("inlineCode",{parentName:"h4"},"ParsePlugin")," \u63d2\u4ef6\u91cc\uff0c\u770b\u6700\u540e\u4e00\u5c42\u7684\u5904\u7406\u903b\u8f91\uff0c\u5b9e\u73b0\u95ed\u73af"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ParsePlugin")," \u63d2\u4ef6\uff0c\u662f\u5f53\u524d\u4e3b\u6d41\u7a0b \u95ed\u73af\u7684\u7ed3\u675f\uff0c\u4e5f\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"\u6587\u4ef6\u89e3\u6790")," \u6d41\u7a0b\u7684\u5f00\u59cb\uff0c\u56e0\u4e3a \u4ece\u6587\u7ae0\u5f00\u5934\u5f00\u59cb\u5230\u73b0\u5728\uff0c\u8fd8\u6ca1\u6709\u771f\u6b63\u7684\u9488\u5bf9 ",(0,o.kt)("inlineCode",{parentName:"p"},"\u6587\u4ef6\u89e3\u6790")," \u76f8\u5173\u7684\u4e8b\u60c5 \u505a\u76f8\u5173\u64cd\u4f5c\uff0c\u5168\u662f\u5728\u6ce8\u518c\u4e00\u4e9b ",(0,o.kt)("inlineCode",{parentName:"p"},"hook"),"\uff0c\u5b9e\u4f8b\u5316 ",(0,o.kt)("inlineCode",{parentName:"p"},"Resolve")," \u5bf9\u8c61\uff0c\u5904\u7406\u683c\u5f0f\u5316\u5165\u53c2\u3002"),(0,o.kt)("p",null,"\u4e0a\u4ee3\u7801\uff0c\u770b\u5177\u4f53\u903b\u8f91\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"\u73b0\u8eab\u5427 \u6211\u7684\u5c0f\u5b9d\u8d1d"),"\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'/*\n MIT License http://www.opensource.org/licenses/mit-license.php\n Author Tobias Koppers @sokra\n*/\n\n"use strict";\n\n/` @typedef {import("./Resolver")} Resolver */\n/` @typedef {import("./Resolver").ResolveRequest} ResolveRequest */\n/` @typedef {import("./Resolver").ResolveStepHook} ResolveStepHook */\n\nmodule.exports = class ParsePlugin {\n /`\n  * @param {string | ResolveStepHook} source source\n  * @param {Partial<ResolveRequest>} requestOptions request options\n  * @param {string | ResolveStepHook} target target\n  */\n constructor(source, requestOptions, target) {\n  // \u63a5\u53d7\u53c2\u6570 \u5e76\u7ed1\u5b9a\u5230this \u4e0a\n  this.source = source;\n  this.requestOptions = requestOptions;\n  this.target = target;\n }\n\n /`\n  * @param {Resolver} resolver the resolver\n  * @returns {void}\n  */\n apply(resolver) {\n  // \u8fd9\u4e2aresolver \u5c31\u662f\u4e4b\u524d \u521b\u5efa\u7684 Resolver  \u7684\u5b9e\u4f53\u7c7b\n  const target = resolver.ensureHook(this.target);\n  resolver\n   // \u5f97\u5230 this.source \u5bf9\u5e94\u7684 hook\n   .getHook(this.source)\n   // \u76d1\u542c this.source \u5bf9\u5e94\u7684 hook\uff0c\u5e76\u8bbe\u7f6e \u8ba2\u9605\u51fd\u6570\n   .tapAsync("ParsePlugin", (request, resolveContext, callback) => {\n    // \u5148\u521d\u6b65\u89e3\u6790 \u5f97\u5230\u5927\u81f4\u7ed3\u679c\uff1a\n    const parsed = resolver.parse(/` @type {string} */ (request.request));\n    // \u5408\u5e76\u53c2\u6570\n    const obj = { ...request, ...parsed, ...this.requestOptions };\n    if (request.query && !parsed.query) {\n     obj.query = request.query;\n    }\n    if (request.fragment && !parsed.fragment) {\n     obj.fragment = request.fragment;\n    }\n    if (parsed && resolveContext.log) {\n     if (parsed.module) resolveContext.log("Parsed request is a module");\n     if (parsed.directory)\n      resolveContext.log("Parsed request is a directory");\n    }\n    // There is an edge-case where a request with ## can be a path or a fragment -> try both\n    if (obj.request && !obj.query && obj.fragment) {\n     const directory = obj.fragment.endsWith("/");\n     const alternative = {\n      ...obj,\n      directory,\n      request:\n       obj.request +\n       (obj.directory ? "/" : "") +\n       (directory ? obj.fragment.slice(0, -1) : obj.fragment),\n      fragment: ""\n     };\n     // \u8fd9\u4e2a hook \u505a\u5b8c\u4e86 \u5b83\u8be5\u505a\u7684\u4e8b\u60c5\u4e86 \u8fdb\u5165 this.target \u7684 hook \u903b\u8f91\u5427\uff0c\n     // \u5e76\u628a\u5f53\u524dhook \u5904\u7406\u8fc7\u7684\u7ed3\u679c\u4f20\u9012\u7ed9this.target \u7684 hook\n     resolver.doResolve(\n      target,\n      alternative,\n      null,\n      resolveContext,\n      (err, result) => {\n       if (err) return callback(err);\n       if (result) return callback(null, result);\n       resolver.doResolve(target, obj, null, resolveContext, callback);\n      }\n     );\n     return;\n    }\n    resolver.doResolve(target, obj, null, resolveContext, callback);\n   });\n }\n};\n')),(0,o.kt)("p",null,"\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4e2a\u63d2\u4ef6 \u786e\u5b9e\u5f00\u59cb \u8fdb\u884c ",(0,o.kt)("inlineCode",{parentName:"p"},"request")," \u5b57\u6bb5\u7684\u89e3\u6790\u4e86\uff0c\u7ec8\u4e8e \u5b83\u5f00\u59cb\u5206\u6790\u4f60\u5728 ",(0,o.kt)("inlineCode",{parentName:"p"},"test-hook.js"),' \u4f20\u5165\u7684 "./a" \u5230\u5e95\u662f\u6587\u4ef6\u5939\uff0c\u8fd8\u662f\u6587\u4ef6\u4e86\u3002\ud83d\ude04'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'const request = "./a";\n')),(0,o.kt)("p",null,"\u5728\u8be5\u63d2\u4ef6\u53c8\u7ecf\u8fc7\u4e00\u7cfb\u5217\u7684\u89e3\u6790\u4ee5\u540e\uff0c\u53d1\u73b0\u53c8\u5f00\u59cb\u4f7f\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},"resolver.doResolve")," \u65b9\u6cd5 \u6d41\u8f6c\u5230 ",(0,o.kt)("inlineCode",{parentName:"p"},"this.target")," \u7684 hook \u4e86\u3002 \u573a\u666f\u56de\u6eaf\uff1a"),(0,o.kt)("p",null,"\u5148\u56de\u6eaf\u4e00\u4e0b\u5f53\u524d\u7684 this.target \u662f\u4ee3\u8868\u7684\u90a3\u4e2a\u53c2\u6570\uff1f"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'plugins.push(new ParsePlugin(source, resolveOptions, "parsed-resolve"));\n')),(0,o.kt)("p",null,"\u7136\u540e\u56de\u60f3\u4e00\u4e0b",(0,o.kt)("inlineCode",{parentName:"p"},"resolver.doResolve")," \u65b9\u6cd5\u505a\u4e86\u5565\uff1f \u6b64\u65f6 hook \u7684\u5165\u53c2\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},'"parsed-resolve"'),", ",(0,o.kt)("inlineCode",{parentName:"p"},"request")," \u53c2\u6570\u4ee3\u8868\u7684\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"resolve")," hook \u5904\u7406\u8fc7\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"alternative")," \u53d8\u91cf\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'doResolve(hook, request, message, resolveContext, callback) {\n // \u9759\u6001\u65b9\u6cd5 \u6839\u636e\u5f53\u524d hook \u4fe1\u606f \u751f\u6210 \u8c03\u7528\u6808\u4fe1\u606f\n const stackEntry = Resolver.createStackEntry(hook, request);\n\n let newStack;\n // \u5f53\u524d hook \u8c03\u7528\u6808\u4fe1\u606f \u5b58\u5165 newStack \u91cc\n if (resolveContext.stack) {\n  newStack = new Set(resolveContext.stack);\n  if (resolveContext.stack.has(stackEntry)) {\n   /`\n    * Prevent recursion\n    * @type {Error & {recursion?: boolean}}\n    */\n   const recursionError = new Error(\n    "Recursion in resolving\\nStack:\\n  " +\n     Array.from(newStack).join("\\n  ")\n   );\n   recursionError.recursion = true;\n   if (resolveContext.log)\n    resolveContext.log("abort resolving because of recursion");\n   return callback(recursionError);\n  }\n  newStack.add(stackEntry);\n } else {\n  newStack = new Set([stackEntry]);\n }\n // \u4f20\u5165 hook, request \u8c03\u7528 resolveStep \u7684 hook\n this.hooks.resolveStep.call(hook, request);\n // \u5982\u679c\u5f53\u524dhook \u88ab\u4f7f\u7528\u4e86\n if (hook.isUsed()) {\n  const innerContext = createInnerContext(\n   {\n    log: resolveContext.log,\n    yield: resolveContext.yield,\n    fileDependencies: resolveContext.fileDependencies,\n    contextDependencies: resolveContext.contextDependencies,\n    missingDependencies: resolveContext.missingDependencies,\n    stack: newStack\n   },\n   message\n  );\n  // \u89e6\u53d1\u5f53\u524dhook \u5e76\u4f20\u5165 request \u548c innerContext \u5f53\u505a\u53c2\u6570\n  return hook.callAsync(request, innerContext, (err, result) => {\n   if (err) return callback(err);\n   if (result) return callback(null, result);\n   callback();\n  });\n } else {\n  // \u6267\u884c callback \u903b\u8f91\n  callback();\n }\n}\n')),(0,o.kt)("p",null,"\u6240\u4ee5\u5f53\u524d\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"this.target")," \u6307\u7684\u662f",(0,o.kt)("inlineCode",{parentName:"p"},"parsed-resolve")," \u76f8\u5173\u7684 hook\uff0c\u76f8\u5f53\u7684\u89c1\u540d\u77e5\u610f\u3002\u81f3\u4e8e\u63a5\u4e0b\u6765\u7684\u6d41\u7a0b\uff0c\u6253\u7b97\u53e6\u5f00\u4e00\u7bc7\u6587\u7ae0\u53bb \u89e3\u8bf4 ",(0,o.kt)("inlineCode",{parentName:"p"},"resolver")," \u8be6\u7ec6\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"hook")," \u6d41\u8f6c\u8fc7\u7a0b\uff0c\u611f\u5174\u8da3\u7684\u5144\u5f1f\u4eec\u53ef\u4ee5\u81ea\u5df1\u62c9\u4ee3\u7801\u8fdb\u884c\u5b66\u4e60\u3002"),(0,o.kt)("h2",{id:"4-\u5b8c\u7ed3\u6492\u82b1"},"4. \u5b8c\u7ed3\u6492\u82b1"),(0,o.kt)("p",null,"\u7ec8\u4e8e\uff0c\u7ecf\u8fc7\u4e86\u4e00\u8def\u7684\u515c\u515c\u8f6c\u8f6c\uff0c\u8fd9\u4e2a resolve \u7ec8\u4e8e\u5f00\u59cb\u89e3\u6790\u4e86\u3002\u6765\u5f20\u6d41\u7a0b\u56fe\uff0c\u603b\u7ed3\u4e00\u4e0b\u5168\u6587\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png",src:t(14772).Z,width:"798",height:"503"})),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"ResolverFactory.createResolver \u6839\u636e ",(0,o.kt)("inlineCode",{parentName:"li"},"Resolver")," \u7c7b\u521b\u5efa\u5b9e\u4f8b\uff1a ",(0,o.kt)("inlineCode",{parentName:"li"},"myResolve")," (\u5403\u4e86\u914d\u7f6e\uff0c\u5410\u51fa\u5bf9\u8c61",(0,o.kt)("inlineCode",{parentName:"li"},"myResolve"),")"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"myResolve \u4e0a \u6ce8\u518c\u5e76\u8ba2\u9605")," \u5927\u91cf\u7684 hook \uff08\u67aa\u652f\u5f39\u836f\u8d2e\u5907\u597d\uff0c\u4e00\u523b\u6fc0\u53d1\uff09"),(0,o.kt)("li",{parentName:"ol"},"\u8c03\u7528 ",(0,o.kt)("inlineCode",{parentName:"li"},"myResolver.resolve")," \u65b9\u6cd5\u5f00\u59cb\u8fdb\u884c \u6587\u4ef6\u89e3\u6790 \u7684\u4e3b\u6d41\u7a0b"),(0,o.kt)("li",{parentName:"ol"},"\u5185\u90e8\u901a\u8fc7 ",(0,o.kt)("inlineCode",{parentName:"li"},"resolve.doResolve"),"\u65b9\u6cd5\uff0c\u5f00\u59cb\u8c03\u7528\u7b2c\u4e00\u4e2a hook: ",(0,o.kt)("inlineCode",{parentName:"li"},"this.hooks.resolve")),(0,o.kt)("li",{parentName:"ol"},"\u627e\u5230\u4e4b\u524d \u8ba2\u9605 hook \u7684 plugin\uff1a",(0,o.kt)("inlineCode",{parentName:"li"},"ParsePlugin")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("inlineCode",{parentName:"li"},"ParsePlugin")," \u8fdb\u884c\u521d\u6b65\u89e3\u6790\uff0c\u7136\u540e \u901a\u8fc7",(0,o.kt)("inlineCode",{parentName:"li"},"doResolve")," \u6267\u884c\u4e0b\u4e00\u4e2a hook ",(0,o.kt)("inlineCode",{parentName:"li"},"parsed-resolve"),"\uff0c\u524d\u671f\u51c6\u5907\u5de5\u4f5c\u7ed3\u675f\uff0c\u94fe\u5f0f\u8c03\u7528\u5f00\u59cb\uff0c",(0,o.kt)("inlineCode",{parentName:"li"},"\u771f\u6b63\u7684\u89e3\u6790\u6587\u4ef6\u7684\u6d41\u7a0b"),"\u4e5f\u5f00\u59cb\u3002")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"\u672c\u6587 Gitee \u89e3\u6790\u5730\u5740\uff1a` [fujunkui/enhanced-resolve (gitee.com)](https://link.juejin.cn/?target=https%3A%2F%2Fgitee.com%2Ffujunkui1996%2Fenhanced-resolve) `\u3010\u5f3a\u70c8\u63a8\u8350\u3011\n")),(0,o.kt)("p",null,"\u672c\u6587 GitHub \u89e3\u6790\u5730\u5740\uff1a ",(0,o.kt)("a",{parentName:"p",href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ffu1996%2Fenhanced-resolve%2Ftree%2Ffeature-study-enhanced"},"fu1996/enhanced-resolve at feature-study-enhanced (github.com)")),(0,o.kt)("p",null,"\u770b\u5230\u8fd9\u91cc\uff0c\u5982\u679c\u611f\u89c9\u5934\u75d2\uff08\u662f\u8981\u957f\u77e5\u8bc6\u4e86\uff09\uff0c\u5b66\u5230\u4e86\u4e00\u4e22\u4e22\u77e5\u8bc6\uff0c\u6b22\u8fce\u5404\u4f4d\u5927\u4f6c\u70b9",(0,o.kt)("inlineCode",{parentName:"p"},"start"),"\u3002"),(0,o.kt)("p",null,"\u4e0b\u4e00\u7bc7\u6587\u6863\uff1aenhance-resolve \u4e2d\u7684\u6570\u636e\u6d41\u52a8\uff1a",(0,o.kt)("a",{parentName:"p",href:"https://juejin.cn/post/7204356282588676156"},"\u3010\u5e72\u8d27\u3011\u8017\u65f6 7 \u4e2a\u5c0f\u65f6\uff0c\u7528\u8fd1 50 \u5f20\u56fe\u6765\u5b66\u4e60 enhance-resolve \u4e2d\u7684\u6570\u636e\u6d41\u52a8\u548c\u63d2\u4ef6\u8c03\u5ea6\u673a\u5236 - \u6398\u91d1 (juejin.cn)"),"\u3002"))}d.isMDXComponent=!0},1189:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/08735284cd6941369d8ff072d3cde9aa~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-536a4260108d54422e30485670c67141.png"},14171:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/0a31bfaf8e124e5787bc1b303352571a~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-888e8ec39ced4e9cd9e55e4612bf60a5.png"},64476:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/0a7c026a2f274affab1837d1c099196a~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-9b421ad713eacc92d277b0da37f76baf.png"},73906:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/30d8fd5e6e034b01aaa81d7c83145f4b~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-a4949fc1addf53152e49b3fe816fd70f.png"},27269:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/35be9e727aad4f8292f8ea13e60e960c~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-50fc4bd5c484d29099dbea011dcac62b.png"},72631:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/3c0b0bd2c32c4d6799693b3f71a5a349~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-5d89a429334cdafb857a035bb2e85a9c.png"},97589:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/7d765bf9d5c841179630fc94f19423f2~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-81e1d060e22cff6036e8aa02ccea91b0.png"},28315:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/cfecb30b0f9a427580e5d9fbba3725a3~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-3f204a67e0ae3f82103eaa9cee2da762.png"},5792:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/d29a5292193f49959f563668997def2d~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-031ad14cce905f04c57b765b8a5c7e8f.png"},33969:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/f17fce9fa2914491ad79f704a5bb5a97~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-3b9cee6adb83757449da18634bd6b818.png"},29663:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/f2b516b83747480398dc37bcb98f79f2~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-683dd4b0948b55c8ff5067f4ebd2da2e.png"},14772:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/fb7f9dbc0c9a4da4b93fe5864aaf9ae3~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0-9d982768bdd1ed03cdfc1af8082ff361.png"}}]);